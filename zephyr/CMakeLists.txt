zephyr_library_named("thingset++")

set(CMAKE_CXX_STANDARD 20)

get_filename_component(THINGSET_BASE ${CMAKE_CURRENT_SOURCE_DIR} DIRECTORY)

set(ENABLE_ZEPHYR ON)

if(DEFINED CONFIG_THINGSET_PLUS_PLUS_SERVER)
    set(ENABLE_SERVER ON)
endif()

if(DEFINED CONFIG_THINGSET_PLUS_PLUS_CLIENT)
    set(ENABLE_CLIENT ON)
endif()

if (DEFINED CONFIG_THINGSET_PLUS_PLUS_BACKEND_CAN)
    set(ENABLE_CAN ON)
endif()

if (DEFINED CONFIG_THINGSET_PLUS_PLUS_BACKEND_SOCKET)
    set(ENABLE_SOCKETS ON)
endif()

if (DEFINED CONFIG_THINGSET_PLUS_PLUS_PROTOCOL_TEXT)
    set(ENABLE_TEXT_MODE ON)
    add_definitions(-DENABLE_TEXT_MODE)
endif()

zephyr_include_directories(${THINGSET_BASE}/include)

add_subdirectory_ifdef(CONFIG_THINGSET_PLUS_PLUS ${THINGSET_BASE}/src build)
